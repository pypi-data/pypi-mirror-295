export const id=4624;export const ids=[4624];export const modules={96979:(t,e,s)=>{s.d(e,{I:()=>n});s(89655),s(253),s(54846),s(78266);class a{constructor(t=window.localStorage){this.storage=void 0,this._storage={},this._listeners={},this.storage=t,t===window.localStorage&&window.addEventListener("storage",(t=>{t.key&&this.hasKey(t.key)&&(this._storage[t.key]=t.newValue?JSON.parse(t.newValue):t.newValue,this._listeners[t.key]&&this._listeners[t.key].forEach((e=>e(t.oldValue?JSON.parse(t.oldValue):t.oldValue,this._storage[t.key]))))}))}addFromStorage(t){if(!this._storage[t]){const e=this.storage.getItem(t);e&&(this._storage[t]=JSON.parse(e))}}subscribeChanges(t,e){return this._listeners[t]?this._listeners[t].push(e):this._listeners[t]=[e],()=>{this.unsubscribeChanges(t,e)}}unsubscribeChanges(t,e){if(!(t in this._listeners))return;const s=this._listeners[t].indexOf(e);-1!==s&&this._listeners[t].splice(s,1)}hasKey(t){return t in this._storage}getValue(t){return this._storage[t]}setValue(t,e){const s=this._storage[t];this._storage[t]=e;try{void 0===e?this.storage.removeItem(t):this.storage.setItem(t,JSON.stringify(e))}catch(t){}finally{this._listeners[t]&&this._listeners[t].forEach((t=>t(s,e)))}}}const i={},n=t=>e=>{const s=t.storage||"localStorage";let n;s&&s in i?n=i[s]:(n=new a(window[s]),i[s]=n);const o=String(e.key),r=t.key||String(e.key),d=e.initializer?e.initializer():void 0;n.addFromStorage(r);const c=!1!==t.subscribe?t=>n.subscribeChanges(r,((s,a)=>{t.requestUpdate(e.key,s)})):void 0,h=()=>n.hasKey(r)?t.deserializer?t.deserializer(n.getValue(r)):n.getValue(r):d;return{kind:"method",placement:"prototype",key:e.key,descriptor:{set(s){((s,a)=>{let i;t.state&&(i=h()),n.setValue(r,t.serializer?t.serializer(a):a),t.state&&s.requestUpdate(e.key,i)})(this,s)},get:()=>h(),enumerable:!0,configurable:!0},finisher(s){if(t.state&&t.subscribe){const t=s.prototype.connectedCallback,e=s.prototype.disconnectedCallback;s.prototype.connectedCallback=function(){t.call(this),this[`__unbsubLocalStorage${o}`]=c?.(this)},s.prototype.disconnectedCallback=function(){e.call(this),this[`__unbsubLocalStorage${o}`]?.(),this[`__unbsubLocalStorage${o}`]=void 0}}t.state&&s.createProperty(e.key,{noAccessor:!0,...t.stateOptions})}}}},37334:(t,e,s)=>{s.a(t,(async(t,a)=>{try{s.d(e,{o:()=>p});var i=s(65513),n=s(31195),o=s(6711),r=s(83324),d=s(57636),c=s(57289),h=s(41924),u=t([d,c,h]);function l(t,e){let s=new Date(e);return t>2&&0===s.getHours()&&(s=(0,i.O)(s,1)),s.setMinutes(0,0,0),t>35&&s.setDate(1),t>2&&s.setHours(0),s.getTime()}function p(t,e,s,a,i,u,p){const g=(0,n.c)(e,t),_=void 0!==u&&void 0!==p;if(_&&g<=35){const s=(0,o.M)(e,t),a=(0,o.M)(p,u);a>s?e=(0,r.L)(e,a-s):s>a&&(p=(0,r.L)(p,s-a))}const f={parsing:!1,animation:!1,interaction:{mode:"x"},scales:{x:{type:"time",suggestedMin:t.getTime(),max:l(g,e),adapters:{date:{locale:s,config:a}},ticks:{maxRotation:0,sampleSize:5,autoSkipPadding:20,font:t=>t.tick&&t.tick.major?{weight:"bold"}:{}},time:{tooltipFormat:g>35?"monthyear":g>7?"date":g>2?"weekday":g>0?"datetime":"hour",minUnit:g>35?"month":g>2?"day":"hour"}},y:{stacked:!0,type:"linear",title:{display:!0,text:i},ticks:{beginAtZero:!0,callback:t=>(0,d.ZV)(Math.abs(t),s)}}},plugins:{tooltip:{position:"nearest",filter:t=>"0"!==t.formattedValue,itemSort:function(t,e){return e.datasetIndex-t.datasetIndex},callbacks:{title:t=>{if(g>0)return t[0].label;const e=new Date(t[0].parsed.x);return`${_?`${(0,c.sl)(e,s,a)}: `:""}${(0,h.fU)(e,s,a)} â€“ ${(0,h.fU)((0,r.L)(e,1),s,a)}`},label:t=>`${t.dataset.label}: ${(0,d.ZV)(t.parsed.y,s)} ${i}`}},filler:{propagate:!1},legend:{display:!1,labels:{usePointStyle:!0}}},elements:{bar:{borderWidth:1.5,borderRadius:4},point:{hitRadius:50}},locale:(0,d.Yf)(s)};return _&&(f.scales.xAxisCompare={...f.scales.x,suggestedMin:u.getTime(),max:l(g,p),display:!1}),f}[d,c,h]=u.then?(await u)():u,a()}catch(g){a(g)}}))},1799:(t,e,s)=>{s.a(t,(async(t,a)=>{try{s.r(e),s.d(e,{HuiEnergyDevicesDetailGraphCard:()=>v});var i=s(36312),n=(s(89655),s(253),s(2075),s(54846),s(16891),s(79784)),o=s(75697),r=s(15112),d=s(77706),c=s(85323),h=s(94100),u=s(46999),l=(s(13082),s(47076)),p=s(4826),g=s(20712),_=s(7934),f=s(37334),k=s(96979),m=t([l,f]);[l,f]=m.then?(await m)():m;const y="kWh";let v=(0,i.A)([(0,d.EM)("hui-energy-devices-detail-graph-card")],(function(t,e){return{F:class extends e{constructor(...e){super(...e),t(this)}},d:[{kind:"field",decorators:[(0,d.MZ)({attribute:!1})],key:"hass",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_config",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_chartData",value:()=>({datasets:[]})},{kind:"field",decorators:[(0,d.wk)()],key:"_chartDatasetExtra",value:()=>[]},{kind:"field",decorators:[(0,d.wk)()],key:"_data",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_start",value:()=>(0,n.R)()},{kind:"field",decorators:[(0,d.wk)()],key:"_end",value:()=>(0,o.o)()},{kind:"field",decorators:[(0,d.wk)()],key:"_compareStart",value:void 0},{kind:"field",decorators:[(0,d.wk)()],key:"_compareEnd",value:void 0},{kind:"field",decorators:[(0,k.I)({key:"energy-devices-hidden-stats",state:!0,subscribe:!1})],key:"_hiddenStats",value:()=>[]},{kind:"field",key:"hassSubscribeRequiredHostProps",value:()=>["_config"]},{kind:"method",key:"hassSubscribe",value:function(){return[(0,l.tb)(this.hass,{key:this._config?.collection_key}).subscribe((t=>{this._data=t,this._processStatistics()}))]}},{kind:"method",key:"getCardSize",value:function(){return 3}},{kind:"method",key:"setConfig",value:function(t){this._config=t}},{kind:"method",key:"shouldUpdate",value:function(t){return(0,_.xP)(this,t)||t.size>1||!t.has("hass")}},{kind:"method",key:"willUpdate",value:function(t){(t.has("_hiddenStats")||t.has("_config"))&&this._data&&this._processStatistics()}},{kind:"method",key:"render",value:function(){return this.hass&&this._config?r.qy` <ha-card> ${this._config.title?r.qy`<h1 class="card-header">${this._config.title}</h1>`:""} <div class="content ${(0,c.H)({"has-header":!!this._config.title})}"> <ha-chart-base externalHidden .hass="${this.hass}" .data="${this._chartData}" .extraData="${this._chartDatasetExtra}" .options="${this._createOptions(this._start,this._end,this.hass.locale,this.hass.config,y,this._compareStart,this._compareEnd)}" chart-type="bar" @dataset-hidden="${this._datasetHidden}" @dataset-unhidden="${this._datasetUnhidden}"></ha-chart-base> </div> </ha-card> `:r.s6}},{kind:"method",key:"_datasetHidden",value:function(t){this._hiddenStats=[...this._hiddenStats,this._data.prefs.device_consumption[t.detail.index].stat_consumption]}},{kind:"method",key:"_datasetUnhidden",value:function(t){this._hiddenStats=this._hiddenStats.filter((e=>e!==this._data.prefs.device_consumption[t.detail.index].stat_consumption))}},{kind:"field",key:"_createOptions",value:()=>(0,h.A)(((t,e,s,a,i,n,o)=>{const r=(0,f.o)(t,e,s,a,i,n,o);return{...r,interaction:{mode:"nearest"},plugins:{...r.plugins,legend:{display:!0,labels:{usePointStyle:!0}}}}}))},{kind:"method",key:"_processStatistics",value:function(){const t=this._data,e=t.stats,s=t.statsCompare,a=getComputedStyle(this),i={};t.prefs.device_consumption.forEach((t=>{const s=t.stat_consumption in e&&(0,p.$j)(e[t.stat_consumption])||0;i[t.stat_consumption]=s}));const n=t.prefs.device_consumption.map((t=>t.stat_consumption));n.sort(((t,e)=>i[e]-i[t]));const r=[],d=[],{data:c,dataExtras:h}=this._processDataSet(a,e,t.statsMetadata,t.prefs.device_consumption,n);if(r.push(...c),d.push(...h),s){r.push({order:0,data:[]}),d.push({show_legend:!1}),r.push({order:999,data:[],xAxisID:"xAxisCompare"}),d.push({show_legend:!1});const{data:e,dataExtras:i}=this._processDataSet(a,s,t.statsMetadata,t.prefs.device_consumption,n,!0);r.push(...e),d.push(...i)}this._start=t.start,this._end=t.end||(0,o.o)(),this._compareStart=t.startCompare,this._compareEnd=t.endCompare,this._chartData={datasets:r},this._chartDatasetExtra=d}},{kind:"method",key:"_processDataSet",value:function(t,e,s,a,i,n=!1){const o=[],r=[];return a.forEach(((a,d)=>{const c=(0,u.fI)(d,t);let h=null;const l=[];if(a.stat_consumption in e){const t=e[a.stat_consumption];let s;for(const e of t){if(null===e.change||void 0===e.change)continue;if(h===e.start)continue;const t=new Date(e.start);l.push({x:t.getTime(),y:e.change}),h=e.start,s=e.end}1===l.length&&l.push({x:s,y:0})}const g=i.indexOf(a.stat_consumption),_=!!(this._config?.max_devices&&g>=this._config.max_devices);o.push({label:a.name||(0,p.$O)(this.hass,a.stat_consumption,s[a.stat_consumption]),hidden:this._hiddenStats.includes(a.stat_consumption)||_,borderColor:n?c+"7F":c,backgroundColor:n?c+"32":c+"7F",data:l,order:1+g,stack:"devices",pointStyle:!n&&"circle",xAxisID:n?"xAxisCompare":void 0}),r.push({show_legend:!n&&!_})})),{data:o,dataExtras:r}}},{kind:"get",static:!0,key:"styles",value:function(){return r.AH`.card-header{padding-bottom:0}.content{padding:16px}.has-header{padding-top:0}`}}]}}),(0,g.E)(r.WF));a()}catch(t){a(t)}}))},61310:(t,e,s)=>{s.d(e,{f:()=>n});var a=s(30429),i=s(59613);function n(t,e){const s=(0,a.a)(t);return isNaN(e)?(0,i.w)(t,NaN):e?(s.setDate(s.getDate()+e),s):s}},83324:(t,e,s)=>{s.d(e,{L:()=>n});var a=s(31293),i=s(3941);function n(t,e){return(0,a.A)(t,e*i.s0)}},31293:(t,e,s)=>{s.d(e,{A:()=>n});var a=s(30429),i=s(59613);function n(t,e){const s=+(0,a.a)(t);return(0,i.w)(t,s+e)}},39902:(t,e,s)=>{s.d(e,{P:()=>n});var a=s(30429),i=s(59613);function n(t,e){const s=(0,a.a)(t);if(isNaN(e))return(0,i.w)(t,NaN);if(!e)return s;const n=s.getDate(),o=(0,i.w)(t,s.getTime());o.setMonth(s.getMonth()+e+1,0);return n>=o.getDate()?o:(s.setFullYear(o.getFullYear(),o.getMonth(),n),s)}},24226:(t,e,s)=>{s.d(e,{z:()=>i});var a=s(30429);function i(t,e){const s=(0,a.a)(t),i=(0,a.a)(e),n=s.getTime()-i.getTime();return n<0?-1:n>0?1:n}},6711:(t,e,s)=>{s.d(e,{M:()=>o});var a=s(48240),i=s(3941),n=s(27320);function o(t,e,s){const o=(0,n.b)(t,e)/i.s0;return(0,a.u)(s?.roundingMethod)(o)}},27320:(t,e,s)=>{s.d(e,{b:()=>i});var a=s(30429);function i(t,e){return+(0,a.a)(t)-+(0,a.a)(e)}},72730:(t,e,s)=>{s.d(e,{W:()=>r});var a=s(24226),i=s(30429);function n(t,e){const s=(0,i.a)(t),a=(0,i.a)(e);return 12*(s.getFullYear()-a.getFullYear())+(s.getMonth()-a.getMonth())}var o=s(91103);function r(t,e){const s=(0,i.a)(t),r=(0,i.a)(e),d=(0,a.z)(s,r),c=Math.abs(n(s,r));let h;if(c<1)h=0;else{1===s.getMonth()&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-d*c);let e=(0,a.z)(s,r)===-d;(0,o.c)((0,i.a)(t))&&1===c&&1===(0,a.z)(t,r)&&(e=!1),h=d*(c-Number(e))}return 0===h?0:h}},60132:(t,e,s)=>{s.d(e,{D:()=>i});var a=s(30429);function i(t){const e=(0,a.a)(t);return e.setHours(23,59,59,999),e}},12152:(t,e,s)=>{s.d(e,{p:()=>i});var a=s(30429);function i(t){const e=(0,a.a)(t),s=e.getMonth();return e.setFullYear(e.getFullYear(),s+1,0),e.setHours(23,59,59,999),e}},75697:(t,e,s)=>{s.d(e,{o:()=>i});var a=s(60132);function i(){return(0,a.D)(Date.now())}},77301:(t,e,s)=>{s.d(e,{e:()=>i});var a=s(30429);function i(t){return 1===(0,a.a)(t).getDate()}},91103:(t,e,s)=>{s.d(e,{c:()=>o});var a=s(60132),i=s(12152),n=s(30429);function o(t){const e=(0,n.a)(t);return+(0,a.D)(e)==+(0,i.p)(e)}},79784:(t,e,s)=>{s.d(e,{R:()=>i});var a=s(63165);function i(){return(0,a.o)(Date.now())}},65513:(t,e,s)=>{s.d(e,{O:()=>i});var a=s(83324);function i(t,e){return(0,a.L)(t,-e)}}};
//# sourceMappingURL=4624.154BOSbtgDc.js.map