<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <template
        id="assets_backend"
        name="oca_sign_assets"
        inherit_id="web.assets_backend"
    >
        <xpath expr="." position="inside">
            <link rel="stylesheet" href="/sign_oca/static/src/scss/sign_oca.scss" />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/components/sign_oca_pdf_common/sign_oca_pdf_common.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/components/sign_oca_pdf_common/sign_oca_pdf_common_action.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/elements/registry.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/elements/text.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/elements/signature.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/elements/check.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/elements/systray.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/components/sign_oca_pdf/sign_oca_pdf.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/components/sign_oca_pdf/sign_oca_pdf_action.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/components/sign_oca_configure/sign_oca_configure.js"
            />
            <script type="text/javascript" src="/sign_oca/static/src/js/sign_oca.js" />
        </xpath>
    </template>
    <template
        id="assets_frontend"
        name="oca_sign_assets_frontend"
        inherit_id="web.assets_frontend"
    >
        <xpath expr="." position="inside">
            <link rel="stylesheet" href="/sign_oca/static/src/scss/sign_oca.scss" />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/components/sign_oca_pdf_common/sign_oca_pdf_common.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/components/sign_oca_pdf/sign_oca_pdf.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/elements/registry.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/elements/text.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/elements/signature.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/elements/check.js"
            />
            <script
                type="text/javascript"
                src="/sign_oca/static/src/components/sign_oca_pdf_portal/sign_oca_pdf_portal.js"
            />
            <link rel="stylesheet" href="/sign_oca/static/src/scss/portal.scss" />
        </xpath>
    </template>
    <template id="sign_assets">
            <link rel="stylesheet" href="/sign_oca/static/src/scss/sign.scss" />
            <link
            rel="stylesheet"
            type="text/css"
            href="/web/static/lib/fontawesome/css/font-awesome.css"
        />
    </template>
    <template id="portal_sign_document">
        <t t-call="web.layout">
            <t t-set="head">
                <meta
                    name="viewport"
                    content="width=device-width, initial-scale=1, user-scalable=no"
                />
                <t t-call-assets="web.assets_common" t-js="false" />
                <t t-call-assets="web.assets_frontend" t-js="false" />
                <t t-call-assets="web.assets_common" t-css="false" />
                <t t-call-assets="web.assets_frontend" t-css="false" />
                <script type="text/javascript">
                    odoo.define("sign.document_portal", function(require) {
                        var ajax = require("web.ajax");
                        var core = require("web.core");
                        var document_signing = require("sign_oca.document_portal_base");
                        document_signing.initDocumentToSign(<t
                        t-raw="json.dumps({'access_token': access_token, 'signer_id': signer.id})"
                    />);
                    });
                </script>
            </t>
        </t>
    </template>
    <template id="portal_sign_document_signed">
        <t t-call="web.layout">
            <t t-set="head">
                <t t-call-assets="web.assets_common" t-js="false" />
                <t t-call-assets="web.assets_frontend" t-js="false" />
            </t>

            <div class="container">
                <div class="o_logo">
                    <img
                        t-attf-src="/web/binary/company_logo?company={{ company.id }}"
                        alt="Logo"
                    />
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2>Document <t
                                t-esc="signer.request_id.name"
                            /> has already been signed</h2>
                    </div>
                    <div class="card-body">
                        <t t-if="signer.request_id.state == 'signed'">
                            You should have received an email with the final document.<br
                            />
                            Check on your mailbox.
                        </t>
                        <t t-elif="signer.request_id.state == 'cancel'">
                            The document has been cancelled
                        </t>
                        <t t-else="">
                            As soon as all signers have signed the document, you will receive an email with the full document
                        </t>
                    </div>
                </div>
            </div>
        </t>
    </template>
    <template t-name="sign_oca_template_mail">
        <div>
            <span>
                <t t-esc="record.create_uid.name" />
                (<a
                    t-att-href="'mailto:%s?subject=%s' % (record.create_uid.email, 'Re: %s' % subject)"
                    style="color:#428BCA; text-decoration:none;"
                    target="_blank"
                ><t t-esc="record.create_uid.email" /></a>)
                has requested your signature on a document.
            </span>
            <span t-if="body">
                <div
                    style="margin: 16px 0px 16px 0px; padding: 8px 16px 8px 16px; background-color: #F1F1F1;"
                >
                    <span>
                        <t t-raw="body" />
                    </span>
                </div>
            </span>
            <span>
                <div style="margin:16px auto; text-align:center;">
                    <a
                        t-att-href="link"
                        style="padding: 8px 16px 8px 16px; border-radius: 3px; background-color:#875A7B; text-align:center; text-decoration:none; color: #FFFFFF;"
                    >
                        Sign document
                    </a>
                </div>
            </span>
            <span>
                <div style="opacity: 0.7;">
                    <strong
                    >Warning</strong> do not forward this email to other people!<br />
                    They will be able to access this document and sign it as yourself.<br
                    />
                </div>
            </span>
        </div>
    </template>

</odoo>
