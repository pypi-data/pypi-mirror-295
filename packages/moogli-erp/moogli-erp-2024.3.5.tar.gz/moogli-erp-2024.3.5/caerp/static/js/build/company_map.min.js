(()=>{"use strict";var e,t,n,r={6455:(e,t,n)=>{var r=n(9722),a=n(6252),i=n(2262),o=n(3577),l=n(3505),u=n(885),c=n(5861),s=n(4687),p=n.n(s),f=(n(4004),n(9483)),d=n.n(f),m=n(569),v=n.n(m);const g=n.p+"5a6cdb62371f4bc880e3e24e76589b1f.css";var h={};h.insert=v().bind(null,"head"),d()(g,h);var _=n(5243),w=n.n(_),y=n(7713),b=n(9022),k=n(2297),S=n(5967),U=n(1664),Z=n(4039),x={key:0};const W={__name:"TextWithBr",props:{text:{type:String,required:!0}},setup:function(e){var t=e,n=(0,a.Fl)((function(){return t.text.split("\n")}));return function(e,t){return(0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(n.value,(function(e,t,r){return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Uk)((0,o.zw)(e)+" ",1),r<n.value.length?((0,a.wg)(),(0,a.iD)("br",x)):(0,a.kq)("v-if",!0)],64)})),256)}}};var j={key:0},C={style:{width:"100%",height:"70vh"},class:"toggle"},O={key:0},D={class:"contacts"},q={key:0},P=["href"],H={key:1},T={key:0},F={key:1},I={class:"contacts"},z={key:0},E=["href"],L={key:1},R=["href"],Y={key:2},M=["href"],$={class:"users"},B={key:0,class:"user_avatar photo"},A=["src","alt"],N={key:1,class:"user_avatar"};const Q={__name:"CompanyMap",props:{companiesUrl:{type:String,required:!0},extraPlacesUrl:{type:String,required:!0}},setup:function(e){return(0,c.Z)(p().mark((function t(){var n,r,l,s,f,d,m,v,g,h,_,x,Q,K,G;return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return m=(0,i.iH)(!0),v=(0,i.iH)({}),g=(0,i.iH)(new(w().Bounds)),h=(0,S.j)(),_=(0,i.iH)(),x=(0,i.iH)(),Q=(0,i.iH)(),K=e,G=function(e){var t=e.getBounds();g.value.isValid()?g.value.extend(t):g.value=t},n=(0,a.mv)((function(){return h.loadConst("config")})),r=(0,u.Z)(n,2),f=r[0],d=r[1],t.next=12,f;case 12:return f=t.sent,d(),v.value=f,l=(0,a.mv)((function(){return Promise.allSettled([U.Z.get(K.companiesUrl),U.Z.get(K.extraPlacesUrl)]).then((function(e){var t=(0,u.Z)(e,2),n=t[0],r=t[1];"fulfilled"==n.status&&n.value&&(_.value=n.value),"fulfilled"==r.status&&r.value&&(x.value=r.value),m.value=!1}))})),s=(0,u.Z)(l,2),f=s[0],d=s[1],t.next=18,f;case 18:return d(),(0,a.m0)((0,c.Z)(p().mark((function e(){return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U.Z.get(K.companiesUrl);case 2:_.value=e.sent;case 3:case"end":return e.stop()}}),e)})))),t.abrupt("return",(function(e,t){return(0,a.wg)(),(0,a.iD)(a.HY,null,[m.value?((0,a.wg)(),(0,a.iD)("div",j,"Chargement…")):(0,a.kq)("v-if",!0),(0,a._)("div",C,[(0,a.Wm)((0,i.SU)(y.iA),{ref:"map",center:[47.21297,-1.55104],zoom:18,bounds:g.value},{default:(0,a.w5)((function(){return[(0,a.Wm)((0,i.SU)(y.HF),{position:"topright",collapsed:!1}),(0,a.Wm)((0,i.SU)(y.Hw),{url:v.value.leaflet_layer_url,attribution:'© Contributeur·ices <a target="_blank" href="http://osm.org/copyright">OpenStreetMap</a>'},null,8,["url"]),(0,a.Wm)((0,i.SU)(y.m7),{name:"Lieux ressources",key:"places","layer-type":"overlay",onReady:G},{default:(0,a.w5)((function(){return[x.value?((0,a.wg)(!0),(0,a.iD)(a.HY,{key:0},(0,a.Ko)(x.value.features,(function(e){return(0,a.wg)(),(0,a.j4)((0,i.SU)(y.$R),{"lat-lng":(0,i.SU)(w()).GeoJSON.coordsToLatLng(e.geometry.coordinates)},{default:(0,a.w5)((function(){return[(0,a.Wm)((0,i.SU)(y.QC),null,{default:(0,a.w5)((function(){return[(0,a.Wm)(k.Z,{name:"location-star","css-class":"map_location favourite",alt:e.properties.name},null,8,["alt"])]})),_:2},1024),(0,a.Wm)((0,i.SU)(y.Q2),null,{default:(0,a.w5)((function(){return[(0,a._)("div",null,[(0,a._)("p",null,[(0,a._)("strong",null,(0,o.zw)(e.properties.name),1)]),e.properties.description?((0,a.wg)(),(0,a.iD)("p",O,[(0,a.Wm)(W,{text:e.properties.description},null,8,["text"])])):(0,a.kq)("v-if",!0),(0,a._)("ul",D,[e.properties.website?((0,a.wg)(),(0,a.iD)("li",q,[(0,a._)("a",{href:e.properties.website},[(0,a.Wm)(k.Z,{name:"globe",alt:"Site web",title:"Site web"}),(0,a.Uk)(" "+(0,o.zw)(e.properties.website),1)],8,P)])):(0,a.kq)("v-if",!0),e.properties.contact?((0,a.wg)(),(0,a.iD)("li",H,[(0,a.Wm)(k.Z,{name:"user",alt:""}),(0,a.Uk)(" Contact : "+(0,o.zw)(e.properties.contact),1)])):(0,a.kq)("v-if",!0)])])]})),_:2},1024)]})),_:2},1032,["lat-lng"])})),256)):(0,a.kq)("v-if",!0)]})),_:1}),(0,a.Wm)((0,i.SU)(b.Y),{name:"Enseignes et entrepreneur·euses",key:"companies","layer-type":"overlay",onReady:G},{default:(0,a.w5)((function(){return[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(_.value.features,(function(e){return(0,a.wg)(),(0,a.j4)((0,i.SU)(y.$R),{"lat-lng":(0,i.SU)(w()).GeoJSON.coordsToLatLng(e.geometry.coordinates),onPopupopen:function(t){return Q.value=e.properties.id}},{default:(0,a.w5)((function(){return[(0,a.Wm)((0,i.SU)(y.QC),null,{default:(0,a.w5)((function(){return[(0,a.Wm)(k.Z,{name:"location-dot","css-class":"map_location",alt:e.properties.name},null,8,["alt"])]})),_:2},1024),(0,a.Wm)((0,i.SU)(y.Q2),null,{default:(0,a.w5)((function(){return[(0,a._)("div",null,[(0,a._)("p",null,[(0,a._)("strong",null,(0,o.zw)(e.properties.name),1)]),e.properties.goal?((0,a.wg)(),(0,a.iD)("p",T,[(0,a._)("em",null,(0,o.zw)(e.properties.goal),1)])):(0,a.kq)("v-if",!0),e.properties.activities_labels.length>0?((0,a.wg)(),(0,a.iD)("p",F,(0,o.zw)(e.properties.activities_labels.join(", ")),1)):(0,a.kq)("v-if",!0),(0,a._)("ul",I,[e.properties.phone?((0,a.wg)(),(0,a.iD)("li",z,[(0,a._)("a",{href:"tel:".concat(e.properties.phone)},[(0,a.Wm)(k.Z,{name:"phone",alt:"Téléphone",title:"Téléphone"}),(0,a.Uk)(" "+(0,o.zw)(e.properties.phone),1)],8,E)])):(0,a.kq)("v-if",!0),e.properties.mobile?((0,a.wg)(),(0,a.iD)("li",L,[(0,a._)("a",{href:"tel:".concat(e.properties.mobile)},[(0,a.Wm)(k.Z,{name:"mobile-alt",title:"Téléphone portable",alt:"Téléphone portable"}),(0,a.Uk)(" "+(0,o.zw)(e.properties.mobile),1)],8,R)])):(0,a.kq)("v-if",!0),e.properties.email?((0,a.wg)(),(0,a.iD)("li",Y,[(0,a._)("a",{href:"mailto:".concat(e.properties.email)},[(0,a.Wm)(k.Z,{name:"envelope",title:"E-mail",alt:"E-mail"}),(0,a.Uk)(" "+(0,o.zw)(e.properties.email),1)],8,M)])):(0,a.kq)("v-if",!0)]),(0,a._)("ul",$,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.properties.users_gallery,(function(t){return(0,a.wg)(),(0,a.iD)("li",null,[(0,a.kq)("\n                         Renders only if the API gives us a logo\n                         + lazy-loading of logos to avoid mass-loading them on page startup.\n                    "),t.logo_url&&Q.value===e.properties.id?((0,a.wg)(),(0,a.iD)("span",B,[(0,a._)("img",{src:t.logo_url,alt:t.fullname,width:"48",height:"48"},null,8,A)])):((0,a.wg)(),(0,a.iD)("span",N,[(0,a.Wm)(Z.Z,{name:"user"})])),(0,a._)("span",null,(0,o.zw)(t.fullname),1)])})),256))])])]})),_:2},1024)]})),_:2},1032,["lat-lng","onPopupopen"])})),256))]})),_:1})]})),_:1},8,["bounds"])])],64)}));case 21:case"end":return t.stop()}}),t)})))()}};var K={class:"nav nav-tabs",role:"tablist"},G={class:"tab-content content"},J={id:"list-container",class:"tab-pane fade in active",role:"tabpanel"},V=["href"];const X={__name:"TabHeader",props:{href:{type:String,default:"#"},active:{type:Boolean,default:!1}},setup:function(e){return function(t,n){return(0,a.wg)(),(0,a.iD)("li",{role:"presentation",class:(0,o.C_)(e.active?"active":"")},[(0,a._)("a",{href:e.href,role:"tab"},[(0,a.WI)(t.$slots,"default")],8,V)],2)}}},ee=(0,a.aZ)({components:{IconSpan:k.Z,TabHeader:X,Icon:Z.Z}}),te=(0,n(3744).Z)(ee,[["render",function(e,t,n,r,i,o){return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("ul",K,[(0,a.WI)(e.$slots,"headers")]),(0,a._)("div",G,[(0,a._)("div",J,[(0,a.WI)(e.$slots,"panels")])])],64)}]]);var ne=n(2201);const re={__name:"App",setup:function(e){var t=(0,l.Yc)(),n=((0,ne.tv)(),(0,ne.yj)()),r="/api/v1/companies.geojson?"+["id","name","phone","email","mobile","goal","activities_labels","logo_id","users_gallery"].map((function(e){return"fields=".concat(e)})).join("&"),u=(0,i.iH)(r);return(0,a.YP)((function(){return n.query}),(function(e){var t=new URLSearchParams(e).toString();u.value="".concat(r,"&").concat(t)})),function(e,n){var r=(0,a.up)("RouterView");return(0,a.wg)(),(0,a.iD)(a.HY,null,[((0,a.wg)(),(0,a.j4)(a.n4,null,{fallback:(0,a.w5)((function(){return[(0,a.Uk)("Chargement…")]})),default:(0,a.w5)((function(){return[(0,a.Wm)(r,{name:"CompanyURLSearchFilters"},{default:(0,a.w5)((function(e){var t=e.Component;return[((0,a.wg)(),(0,a.j4)((0,a.LL)(t)))]})),_:1})]})),_:1})),((0,a.wg)(),(0,a.j4)(a.n4,null,{fallback:(0,a.w5)((function(){return[(0,a.Uk)(" Chargement...")]})),default:(0,a.w5)((function(){return[(0,a.Wm)(te,null,{headers:(0,a.w5)((function(){return[(0,a.Wm)(X,{href:(0,i.SU)(t).tab_url},{default:(0,a.w5)((function(){return[(0,a.Wm)(k.Z,{name:"list",alt:""}),(0,a.Uk)(" "+(0,o.zw)((0,i.SU)(t).tab_title),1)]})),_:1},8,["href"]),(0,a.Wm)(X,{active:""},{default:(0,a.w5)((function(){return[(0,a.Wm)(k.Z,{name:"map-location-dot",alt:""}),(0,a.Uk)(" Carte des enseignes ")]})),_:1})]})),panels:(0,a.w5)((function(){return[(0,a.Wm)(Q,{companiesUrl:u.value,extraPlacesUrl:"/public/cae_places.geojson"},null,8,["companiesUrl"])]})),_:1})]})),_:1}))],64)}}},ae=re;var ie=n(4925),oe=n(2659),le=n(2995),ue={class:"collapsible search_filters expanded"},ce={class:"collapse_title"},se=["id","aria-expanded","title","aria-label"],pe=["id","aria-labelledby","hidden"];const fe={__name:"CollapsibleSearchFilters",props:{title:{required:!0,type:String},initialCollapsedState:{type:Boolean,default:!1},initialFilters:{type:Object,default:{}}},emits:["applyFilters"],setup:function(e,t){var n=t.emit,l=e,u=(0,i.iH)(l.initialCollapsedState),c=(0,r.EL)("accordionPanel"),s=(0,r.EL)("accordionTitle"),p=function(){return u.value=!u.value},f=(0,a.Fl)((function(){return u.value?"Afficher les champs de recherche":"Masquer les champs de recherche"})),d=n,m=Object.assign({},l.initialFilters),v=function(e){return m[e.target.name]=e.target.value},g=function(e){e.preventDefault(),d("applyFilters",m)};return(0,a.YP)((function(){return l.initialFilters}),(function(){return Object.assign(m,l.initialFilters)})),function(t,n){return(0,a.wg)(),(0,a.iD)("div",ue,[(0,a._)("h2",ce,[(0,a._)("a",{href:"#",id:(0,i.SU)(s),"aria-expanded":!u.value,accesskey:"R",title:f.value,"aria-label":f.value,onClick:p},[(0,a.Wm)(k.Z,{name:"search",alt:""}),(0,a.Uk)(" "+(0,o.zw)(e.title)+" ",1),(0,a.Wm)(Z.Z,{class:"arrow",name:"chevron-down"})],8,se)]),(0,a._)("div",{class:"collapse_content",id:(0,i.SU)(c),"aria-labelledby":(0,i.SU)(s),hidden:u.value},[(0,a._)("div",null,[(0,a._)("form",{id:"search_form",class:"form-search form-inline",onChange:v,onSubmit:g},[(0,a.WI)(t.$slots,"default"),(0,a._)("div",null,[(0,a.Wm)(le.Z,{css:"btn-primary",icon:"search",buttonType:"submit",title:"Lancer la recherche avec ces critères",label:"Lancer la recherche avec ces critères"})])],32)])],8,pe)])}}};var de=n(7476),me=n(9039),ve=n(9508),ge=n(1582),he=(0,me.Z)("company"),_e=["goal","name","activities","email","phone","mobile","address","zip_code","city","latitude","longitude","logo","logo_id","cgv","header","header_id","decimal_to_display","internal","code_compta","general_customer_account","general_expense_account","third_party_customer_account","general_supplier_account","third_party_supplier_account","internalgeneral_customer_account","internalthird_party_customer_account","internalgeneral_supplier_account","internalthird_party_supplier_account","contribution","internalcontribution","insurance","internalinsurance","RIB","IBAN","antenne_id","follower_id","use_margin_rate_in_catalog","margin_rate"];(0,de.Q_)("company",{state:function(){return{loading:!0,error:!1,collection:[],collectionMetaData:{},companyId:null,item:{}}},actions:{setCurrentCompanyId:function(e){this.companyId=e},loadCompanies:function(e,t){var n=this;return(0,c.Z)(p().mark((function r(){return p().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return n.loading=!0,r.abrupt("return",ge.Z.companies.getCompanies(e,t).then((function(e){var r;return t.pageOptions&&2==e.length?(n.collectionMetaData=e[0],r=e[1]):r=e,n.loading=!1,n.error="",n.collection=r,r})).catch(n.handleError));case 2:case"end":return r.stop()}}),r)})))()},loadCompany:function(){var e=arguments,t=this;return(0,c.Z)(p().mark((function n(){var r,a;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(null===(a=e.length>1&&void 0!==e[1]?e[1]:null)&&(a=_e),r=(r=e.length>0&&void 0!==e[0]?e[0]:null)||t.companyId){n.next=6;break}throw Error("no Id provided");case 6:return t.loading=!0,n.abrupt("return",ge.Z.companies.load(r,a).then((function(e){return t.loading=!1,t.error=!1,t.item=e,e})).catch(t.handleError));case 8:case"end":return n.stop()}}),n)})))()},handleError:function(e){var t=this;return(0,c.Z)(p().mark((function n(){return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t.loading=!1,t.error=e,n.abrupt("return",Promise.reject(e));case 3:case"end":return n.stop()}}),n)})))()},saveCompany:function(e){var t=this;return(0,c.Z)(p().mark((function n(){var r;return p().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!(r=t.companyId||e.id)){n.next=5;break}return n.abrupt("return",ge.Z.companies.update(e,r));case 5:return n.abrupt("return",t.createCompany(e));case 6:case"end":return n.stop()}}),n)})))()},createCompany:function(e){return(0,c.Z)(p().mark((function t(){return p().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.id){t.next=2;break}throw Error("Company already exists (has an id)");case 2:return t.abrupt("return",ge.Z.companies.create(e));case 3:case"end":return t.stop()}}),t)})))()}},getters:(0,ve.Z)("company")});var we=[{path:"/companies_map",components:{CompanyURLSearchFilters:{__name:"CompanyUrlSearchFilters",setup:function(e){return(0,c.Z)(p().mark((function e(){var t,n,r,o,l,c,s,f,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return l=(0,ne.tv)(),c=(0,ne.yj)(),s=he(),f=function(e){l.push({path:"/companies_map",query:e})},s.setUrl("/api/v1/companies.geojson?form_config=1"),t=(0,a.mv)((function(){return s.loadConfig()})),n=(0,u.Z)(t,2),r=n[0],o=n[1],e.next=8,r;case 8:return o(),d=s.getOptions("activities"),e.abrupt("return",(function(e,t){return(0,a.wg)(),(0,a.j4)(fe,{title:"Recherche",onApplyFilters:f,initialFilters:(0,i.SU)(c).query},{default:(0,a.w5)((function(){return[(0,a.Wm)(ie.Z,{label:"Nom, enseigne, activité",name:"search",value:(0,i.SU)(c).query.search},null,8,["value"]),(0,a.Wm)(oe.Z,{label:"Type d'activité",name:"activity_id",options:(0,i.SU)(d),value:(0,i.SU)(c).query.activity_id,"add-default":"","default-option":{id:"",label:"- Tous les types d'activité -"}},null,8,["options","value"]),(0,a.Wm)(ie.Z,{label:"Code postal",name:"postcode",value:(0,i.SU)(c).query.postcode},null,8,["value"])]})),_:1},8,["initialFilters"])}));case 11:case"end":return e.stop()}}),e)})))()}}}}];(0,r.GP)(ae,"vue-app",we)}},a={};function i(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}};return r[e].call(n.exports,n,n.exports,i),n.exports}i.m=r,e=[],i.O=(t,n,r,a)=>{if(!n){var o=1/0;for(s=0;s<e.length;s++){for(var[n,r,a]=e[s],l=!0,u=0;u<n.length;u++)(!1&a||o>=a)&&Object.keys(i.O).every((e=>i.O[e](n[u])))?n.splice(u--,1):(l=!1,a<o&&(o=a));if(l){e.splice(s--,1);var c=r();void 0!==c&&(t=c)}}return t}a=a||0;for(var s=e.length;s>0&&e[s-1][2]>a;s--)e[s]=e[s-1];e[s]=[n,r,a]},i.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return i.d(t,{a:t}),t},n=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(e,r){if(1&r&&(e=this(e)),8&r)return e;if("object"==typeof e&&e){if(4&r&&e.__esModule)return e;if(16&r&&"function"==typeof e.then)return e}var a=Object.create(null);i.r(a);var o={};t=t||[null,n({}),n([]),n(n)];for(var l=2&r&&e;"object"==typeof l&&!~t.indexOf(l);l=n(l))Object.getOwnPropertyNames(l).forEach((t=>o[t]=()=>e[t]));return o.default=()=>e,i.d(a,o),a},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.e=()=>Promise.resolve(),i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.j=197,(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var r=n.length-1;r>-1&&!e;)e=n[r--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={197:0};i.O.j=t=>0===e[t];var t=(t,n)=>{var r,a,[o,l,u]=n,c=0;if(o.some((t=>0!==e[t]))){for(r in l)i.o(l,r)&&(i.m[r]=l[r]);if(u)var s=u(i)}for(t&&t(n);c<o.length;c++)a=o[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(s)},n=self.webpackChunkenDI=self.webpackChunkenDI||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),i.nc=void 0;var o=i.O(void 0,[382],(()=>i(6455)));o=i.O(o)})();